"use strict";var basketAjax={contaner:".js-ajax-content",page:window.location.href,timeOut:null,start:!1,small_list_status:"is-closed",changeQunatity:function(t){t.parents(".top-small-basket").length>0&&(this.small_list_status="is-opened");var a=parseInt(t.parent().find(".js-count-field").val()),e=t.parent().attr("data-id");t.is("._minus")?1==a?a=1:a-=1:t.is("._plus")&&(a+=1),this.timeOut&&clearTimeout(this.timeOut),this.timeOut=setTimeout((function(){$.post(main_ajax_url,{action:"BASKETUPDATE",id:e,quantity:a},(function(t){"error"!=t.status&&basketAjax.reloadBasket()}))}),500)},addProducts:function(t){var a=t.attr("data-id"),e=t.attr("data-quantity"),i=t.attr("data-parent"),n=t.attr("data-custom_price");$.post(main_ajax_url,{action:"BASKETADD",id:a,quantity:e,parent:i,custom_price:n},(function(t){"error"!=t.status&&basketAjax.reloadBasket()}))},delProducts:function(t){var a=t.attr("data-id"),e=t.attr("data-pid"),i=t.attr("data-parent");$.post(main_ajax_url,{action:"BASKETDEL",id:a,pid:e,parent:i},(function(t){"error"!=t.status&&(basketAjax.reloadBasket(),reloadSmallBasket("TEMPLATE_LK"))}))},paymentChange:function(t){var a=t.val();this.timeOut&&clearTimeout(this.timeOut),this.timeOut=setTimeout((function(){$.post(main_ajax_url,{action:"BASKET_PAY_SYSTEM",pay_id:a},(function(t){basketAjax.reloadBasket()}))}),500)},deliveryChange:function(t){var a=t.attr("data-name");this.timeOut&&clearTimeout(this.timeOut),this.timeOut=setTimeout((function(){$.post(main_ajax_url,{action:"BASKET_DELIVERY",delivery_name:a},(function(t){basketAjax.reloadBasket()}))}),500)},changeUser:function(t){initStyledSelect();var a=t.val();$.post(main_ajax_url,{action:"BASKET_USER_ELEM",user_id:a},(function(t){basketAjax.reloadBasket()}))},fastorder:function(){var t=$('form[name="ORDER_FORM"]').find('input[id="fastorder_input"]').val();"Y"===t&&($('input[name="ORDER_PROP_1"]').val($('input[name="FAST_ORDER_PROP_1"]').val()),$('input[name="ORDER_PROP_2"]').val($('input[name="FAST_ORDER_PROP_2"]').val()),$('input[name="ORDER_PROP_3"]').val("fastorder@vamopt.ru"))},takeInput:function(){var t={},a=$('form[name="ORDER_FORM"]').find("input");for($i=0;$i<a.length;$i++)a[$i].name.indexOf("ORDER_PROP_")>=0&&(t[a[$i].name]=a[$i].value);return t},submit:function(t){var a=t.parents("form"),e=a.attr("action");this.fastorder();var i=a.serialize();$(".ordering-errors").empty(),$.post(e,i,(function(t){if(console.log(t),"undefined"!==t.order.ERROR&&void 0!==t.order.ERROR&&"undefined"!==t.order.ERROR.PROPERTY&&void 0!==t.order.ERROR.PROPERTY){var a=t.order.ERROR.PROPERTY;for($i=0;$i<a.length;$i++)void 0!==a[$i]&&$(".ordering-errors").append("<div>"+a[$i]+"</div>")}t.order.ID>0&&(window.location.href=t.order.REDIRECT_URL)}))},reloadBasket:function(){clearTimeout(this.timeOut);var t=this.page,a=this.contaner;if(t.indexOf("/lk/orders/")>0||t.indexOf("/basket/")>0){var e={};e.props=this.takeInput(),e.basket_ajax_call="Y",e.fastorder=$(a).find('input[id="fastorder_input"]').val(),$.post(t,e,(function(t){$(a).replaceWith(t),initStyledSelect(),showBasketDopProductInfo(),initPhoneMask(),initBasketItemDopProductsSlider()}))}reloadSmallBasket($(".top-small-basket").attr("data-template"),this.small_list_status)}};